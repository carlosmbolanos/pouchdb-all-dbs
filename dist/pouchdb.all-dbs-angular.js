!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.pouchdbAllDbs=e()}}(function(){return function e(t,n,o){function r(u,c){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!c&&s)return s(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return r(n?n:e)},a,a.exports,e,t,n,o)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(e,t,n){function o(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var o=[];if(t){var r=document.createElement("div"),i=new MutationObserver(function(){var e=o.slice();o.length=0,e.forEach(function(e){e()})});return i.observe(r,{attributes:!0}),function(e){o.length||r.setAttribute("yes","no"),o.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),o.length>0)){var n=o.shift();n()}},!0),function(e){o.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=o,r.addListener=o,r.once=o,r.off=o,r.removeListener=o,r.removeAllListeners=o,r.emit=o,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],2:[function(e,t,n){"use strict";function o(e){return c+e}function r(e){return e.slice(c.length)}var i=e("./pouch-utils"),u=e("./taskqueue"),c="db_";t.exports=function(e){function t(e){e&&console.error(e)}function n(){h.add(function(t){return a?t():(a=new e(p),void t())})}function s(e){return e.replace(/^_pouch_/,"")}function f(e){return e===p||e.indexOf("-mrview-")!==-1||/^https?:\/\//.test(e)}var a,l,p="pouch__all_dbs__",h=new u;e.on("created",function(e){e=s(e),f(e)||(e=o(e),n(),h.add(function(t){a.get(e).then(function(){})["catch"](function(t){if("not_found"!==t.name)throw t;return a.put({_id:e})}).then(function(){l&&(l[e]=!0),t()},t)},t))}),e.on("destroyed",function(e){e=s(e),f(e)||(e=o(e),n(),h.add(function(t){a.get(e).then(function(e){return a.remove(e)})["catch"](function(e){if("not_found"!==e.name)throw e}).then(function(){l&&delete l[e],t()},t)},t))}),e.allDbs=i.toPromise(function(e){n(),h.add(function(e){if(l)return e(null,Object.keys(l).map(r));var t={startkey:c,endkey:c+"ï¿¿"};a.allDocs(t).then(function(t){l={};var n=[];t.rows.forEach(function(e){n.push(r(e.key)),l[e.key]=!0}),e(null,n)})["catch"](function(t){console.error(t),e(t)})},e)}),e.resetAllDbs=i.toPromise(function(e){h.add(function(e){a.destroy().then(function(){a=null,l=null,e()})["catch"](function(t){console.error(t),e(t)})},e)})},"undefined"!=typeof window&&window.PouchDB&&t.exports(window.PouchDB)},{"./pouch-utils":3,"./taskqueue":4}],3:[function(e,t,n){(function(t){"use strict";var o=e("pouchdb-promise");n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=-1;++o<t;)n[o]=arguments[o];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(r){var i,u=this,c="function"==typeof r[r.length-1]&&r.pop();c&&(i=function(e,n){t.nextTick(function(){c(e,n)})});var s=new o(function(t,o){try{var i=n.once(function(e,n){e?o(e):t(n)});r.push(i),e.apply(u,r)}catch(c){o(c)}});return i&&s.then(function(e){i(null,e)},i),s.cancel=function(){return this},s})},n.inherits=e("inherits")}).call(this,e("_process"))},{_process:1,inherits:6,"pouchdb-promise":7}],4:[function(e,t,n){(function(n,o){"use strict";function r(){this.queue=new u,this.running=!1}var i=e("argsarray"),u=e("tiny-queue"),c=o.setImmediate||n.nextTick;r.prototype.add=function(e,t){t=t||function(){},this.queue.push({fun:e,callback:t}),this.processNext()},r.prototype.processNext=function(){var e=this;if(!e.running&&e.queue.length){e.running=!0;var t=e.queue.shift();c(function(){t.fun(i(function(n){t.callback.apply(null,n),e.running=!1,e.processNext()}))})}},t.exports=r}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1,argsarray:5,"tiny-queue":10}],5:[function(e,t,n){"use strict";function o(e){return function(){var t=arguments.length;if(t){for(var n=[],o=-1;++o<t;)n[o]=arguments[o];return e.call(this,n)}return e.call(this,[])}}t.exports=o},{}],6:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],7:[function(e,t,n){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e["default"]:e}var r=o(e("lie")),i="function"==typeof Promise?Promise:r;t.exports=i},{lie:8}],8:[function(e,t,n){"use strict";function o(){}function r(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,e!==o&&s(this,e)}function i(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){d(function(){var o;try{o=t(n)}catch(r){return v.reject(e,r)}o===e?v.reject(e,new TypeError("Cannot resolve promise with itself")):v.resolve(e,o)})}function c(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function s(e,t){function n(t){i||(i=!0,v.reject(e,t))}function o(t){i||(i=!0,v.resolve(e,t))}function r(){t(o,n)}var i=!1,u=f(r);"error"===u.status&&n(u.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(o){n.status="error",n.value=o}return n}function a(e){return e instanceof this?e:v.resolve(new this(o),e)}function l(e){var t=new this(o);return v.reject(t,e)}function p(e){function t(e,t){function o(e){u[t]=e,++c!==r||i||(i=!0,v.resolve(f,u))}n.resolve(e).then(o,function(e){i||(i=!0,v.reject(f,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var u=new Array(r),c=0,s=-1,f=new this(o);++s<r;)t(e[s],s);return f}function h(e){function t(e){n.resolve(e).then(function(e){i||(i=!0,v.resolve(c,e))},function(e){i||(i=!0,v.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var u=-1,c=new this(o);++u<r;)t(e[u]);return c}var d=e("immediate"),v={},y=["REJECTED"],w=["FULFILLED"],m=["PENDING"];t.exports=r,r.prototype["catch"]=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if("function"!=typeof e&&this.state===w||"function"!=typeof t&&this.state===y)return this;var n=new this.constructor(o);if(this.state!==m){var r=this.state===w?e:t;u(n,r,this.outcome)}else this.queue.push(new i(n,e,t));return n},i.prototype.callFulfilled=function(e){v.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){v.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},v.resolve=function(e,t){var n=f(c,t);if("error"===n.status)return v.reject(e,n.value);var o=n.value;if(o)s(e,o);else{e.state=w,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},v.reject=function(e,t){e.state=y,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e},r.resolve=a,r.reject=l,r.all=p,r.race=h},{immediate:9}],9:[function(e,t,n){(function(e){"use strict";function n(){a=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}a=!1}function o(e){1!==l.push(e)||a||r()}var r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var u=0,c=new i(n),s=e.document.createTextNode("");c.observe(s,{characterData:!0}),r=function(){s.data=u=++u%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var f=new e.MessageChannel;f.port1.onmessage=n,r=function(){f.port2.postMessage(0)}}var a,l=[];t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,n){"use strict";function o(){this.length=0}o.prototype.push=function(e){var t={item:e};this.last?this.last=this.last.next=t:this.last=this.first=t,this.length++},o.prototype.shift=function(){var e=this.first;if(e)return this.first=e.next,--this.length||(this.last=void 0),e.item},o.prototype.slice=function(e,t){e="undefined"==typeof e?0:e,t="undefined"==typeof t?1/0:t;for(var n=[],o=0,r=this.first;r&&!(--t<0);r=r.next)++o>e&&n.push(r.item);return n},t.exports=o},{}]},{},[2])(2)});
